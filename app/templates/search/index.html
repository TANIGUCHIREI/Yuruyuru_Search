{% extends 'base.html' %}

{% block header %}
  <!-- <div>
    <h1>{% block title %}ベクトル漫画検索{% endblock %}</h1>
  </div> -->
{% endblock %}

{% block content %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
      const startYearSelect = document.querySelector('select[name="start_year"]');
      const endYearSelect = document.querySelector('select[name="end_year"]');
  
      function updateEndYearOptions() {
          const selectedStartYear = parseInt(startYearSelect.value);
          const currentEndYear = parseInt(endYearSelect.value);
  
          // 終了年の選択肢をクリアして、新しい範囲を設定
          endYearSelect.innerHTML = '';
          for (let year = selectedStartYear+1; year <= 2024; year++) {
              const option = document.createElement('option');
              option.value = year;
              option.textContent = year;
              if (year === currentEndYear) {
                  option.selected = true;
              }
              endYearSelect.appendChild(option);
          }
      }
  
      function updateStartYearOptions() {
          const selectedEndYear = parseInt(endYearSelect.value);
          const currentStartYear = parseInt(startYearSelect.value);
  
          // 開始年の選択肢をクリアして、新しい範囲を設定
          startYearSelect.innerHTML = '';
          for (let year = 1900; year < selectedEndYear; year++) {
              const option = document.createElement('option');
              option.value = year;
              option.textContent = year;
              if (year === currentStartYear) {
                  option.selected = true;
              }
              startYearSelect.appendChild(option);
          }
      }
  
      // 開始年の選択が変更されたときに終了年の選択肢を更新
      startYearSelect.addEventListener('change', updateEndYearOptions);
  
      // 終了年の選択が変更されたときに開始年の選択肢を更新
      endYearSelect.addEventListener('change', updateStartYearOptions);

      updateEndYearOptions(); //ロード時に変更してしまう
  });
  </script>
  <form method="post" action="/search" id="searchForm">
    <div class="checkbox-container">
      
      <div class="select-year-container" style="display: flex; text-align: center;">
        <select name="start_year">
            {%for year in range(start_year, end_year)%}
            <option value="{{year}}">{{year}}</option>
            {%endfor%}
        </select>
        <span>年から</span>
        <select name="end_year">
            {%for year in range(end_year, start_year-1, -1)%}
            <option value="{{year}}">{{year}}</option>
            {%endfor%}
        </select>
        <span>年までの</span>
    </div>
      <div class="media-type-checkbox">
        <div>
          <label for="toggleSliders">漫画</label>
          <input type="checkbox" id="manga" checked>
          <label for="toggleSliders">アニメ</label>
          <input type="checkbox" id="manga" checked>
          <label for="toggleSliders">小説</label>
          <input type="checkbox" id="manga" checked>
        </div>

      </div>

      <input type="checkbox" id="searchall" name="searchall" hidden checked>

      <!-- <label for="toggleSliders">検索の割合を指定</label>
      <input type="checkbox" id="toggleSliders"> -->

      <input type="checkbox" id="story_age_checkbox" hidden>
    </div>

    

    <!-- <div class="slider_container">
      <label for="overview_rate"><span class="range_bar">概要</span></label>
      <input type="range" id="overview_rate" name="overview_rate" min="0" max="100" disabled>
      <label for="story_rate"><span class="range_bar">ストーリー</span></label>
      <input type="range" id="story_rate" name="story_rate" min="0" max="100" disabled>
      <label for="character_rate"><span class="range_bar">キャラクター</span></label>
      <input type="range" id="character_rate" name="character_rate" min="0" max="100" disabled>
    </div> -->

    <div class="range-wrapper">
      <div id="range"></div>
    </div>

    <!-- フォーム内に隠しフィールドを追加 -->
    <input type="hidden" id="liData" name="liData">
    <div class="autoComplete_container">
      <br>
      <label >関連カテゴリ・声優の検索方法</label>
      <br>
      <input type="radio" name="AndOR" value="AND" />AND
      <input type="radio" name="AndOR" value="OR" checked/>OR
      <input type="text" id="autoComplete">
          <ul id="list-container"></ul>

    </div>

    <textarea id="inputText" name="inputText" rows="4" placeholder="検索したい質問の要素を入力してください" required></textarea>
    <!-- <input type="type" id="inputText" name="inputText" placeholder="検索したい質問の要素を入力してください" required> -->

    <input type="submit" value="検索">

    <div id="loadingIndicator" style="display: none;">
      Loading...
    </div>
  </form>
  
{% endblock %}